(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-36118bc7"],{"20c5":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-button",{attrs:{type:"danger",size:"medium",loading:t.loading},on:{click:t.openDialog}},[t._v("åˆ é™¤")])},n=[],o=(a("a9e3"),a("d3b7"),a("e6cf"),a("a79d"),a("bc3a")),s=a.n(o),r={name:"SingleDelete",props:{id:{type:Number,required:!0},url:{type:String,required:!0}},data:function(){return{loading:!1}},methods:{openDialog:function(){this.loading||this.$emit("open-dialog",this.singleDelete)},singleDelete:function(){var t=this;return this.loading=!0,s.a.post(this.url,{ids:[this.id]},{headers:{"Content-Type":"application/json;charset=UTF-8"}}).then((function(e){0===e.data.code?(t.$message.success("åˆ é™¤æˆåŠŸï¼"),t.$emit("single-delete")):t.$message.error("åˆ é™¤å¤±è´¥ï¼")})).finally((function(){t.loading=!1}))}}},l=r,c=a("2877"),u=Object(c["a"])(l,i,n,!1,null,null,null);e["a"]=u.exports},"22bf":function(t,e,a){"use strict";var i=a("99410"),n=a.n(i);n.a},"26fd":function(t,e,a){"use strict";var i=a("a1dd"),n=a.n(i);n.a},"2d23":function(t,e,a){},4768:function(t,e,a){},"57af":function(t,e,a){"use strict";var i=a("4768"),n=a.n(i);n.a},"647d":function(t,e,a){"use strict";var i=a("83f0"),n=a.n(i);n.a},"732e":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-form",{ref:"form",attrs:{model:t.formData,rules:t.rules,"label-width":"80px","status-icon":""}},[a("el-form-item",{attrs:{label:"æ ‡é¢˜",prop:"title"}},[a("el-input",{model:{value:t.formData.title,callback:function(e){t.$set(t.formData,"title",e)},expression:"formData.title"}})],1),a("el-form-item",{attrs:{label:0===t.formData.type?"é‡Œç¨‹/km":"æ¬¡æ•°",prop:"aim"}},[a("el-input",{model:{value:t.formData.aim,callback:function(e){t.$set(t.formData,"aim",e)},expression:"formData.aim"}})],1),a("el-form-item",{attrs:{label:"ç±»å‹",required:""}},[a("el-radio",{attrs:{label:0},model:{value:t.formData.type,callback:function(e){t.$set(t.formData,"type",e)},expression:"formData.type"}},[t._v("éª‘è¡Œ")]),a("el-radio",{attrs:{label:1},model:{value:t.formData.type,callback:function(e){t.$set(t.formData,"type",e)},expression:"formData.type"}},[t._v("å…¬äº¤")]),a("el-radio",{attrs:{label:2},model:{value:t.formData.type,callback:function(e){t.$set(t.formData,"type",e)},expression:"formData.type"}},[t._v("åœ°é“")]),a("el-radio",{attrs:{label:3},model:{value:t.formData.type,callback:function(e){t.$set(t.formData,"type",e)},expression:"formData.type"}},[t._v("é«˜é“")])],1),a("el-form-item",{attrs:{label:"ä»»åŠ¡è¦æ±‚",prop:"description"}},[a("el-input",{attrs:{type:"textarea",maxlength:"100","show-word-limit":"",resize:"none",rows:"3"},on:{blur:function(e){return t.trim("description")}},model:{value:t.formData.description,callback:function(e){t.$set(t.formData,"description",e)},expression:"formData.description"}})],1),a("el-form-item",{attrs:{label:"æˆé•¿å€¼",prop:"growth"}},[a("el-input",{model:{value:t.formData.growth,callback:function(e){t.$set(t.formData,"growth",e)},expression:"formData.growth"}})],1),a("el-form-item",{attrs:{label:"ç¢³ç§¯åˆ†",prop:"integral"}},[a("el-input",{model:{value:t.formData.integral,callback:function(e){t.$set(t.formData,"integral",e)},expression:"formData.integral"}})],1),a("el-form-item",{attrs:{label:"ä¼˜æƒ å·",prop:"coupons"}},[a("el-select",{attrs:{placeholder:"è¯·é€‰æ‹©",multiple:""},model:{value:t.formData.coupons,callback:function(e){t.$set(t.formData,"coupons",e)},expression:"formData.coupons"}},t._l(t.options,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",loading:t.loading},on:{click:t.submit}},[t._v("æäº¤")]),a("el-button",{on:{click:t.reset}},[t._v("é‡ç½®")])],1)],1)},n=[],o=(a("a4d3"),a("e01a"),a("d81d"),a("a9e3"),a("bc3a")),s=a.n(o),r=a("e49c"),l={name:"TaskForm",mixins:[r["a"]],props:{id:{type:Number,default:-1},title:{type:String,default:"ä»Šæ—¥éª‘è¡Œ"},aim:{type:Number,default:3},type:{type:Number,default:0},description:{type:String,default:"å½“å¤©éª‘è¡Œé‡Œç¨‹è¾¾åˆ°ä¸‰å…¬é‡Œå³å¯é¢†å–å¥–åŠ±ï¼"},integral:{type:Number,default:10},growth:{type:Number,default:10},coupons:{type:Array,default:function(){return[]}}},data:function(){return{formData:{description:"",title:"",aim:"",type:0,integral:"",growth:"",coupons:[]},rules:{aim:[{required:!0,message:"ä¸èƒ½ä¸ºç©º"},{pattern:/^[1-9][0-9]{0,4}$/,message:"ä¸ç¬¦åˆè¦æ±‚"}],integral:[{required:!0,message:"ä¸èƒ½ä¸ºç©º"},{pattern:/^[1-9][0-9]{0,4}$/,message:"ä¸ç¬¦åˆè¦æ±‚"}],growth:[{required:!0,message:"ä¸èƒ½ä¸ºç©º"},{pattern:/^[1-9][0-9]{0,4}$/,message:"ä¸ç¬¦åˆè¦æ±‚"}],title:[{required:!0,message:"ä¸èƒ½ä¸ºç©º"}],description:[{required:!0,message:"ä¸èƒ½ä¸ºç©º"}]},loading:!1,options:[]}},watch:{id:function(){this.init()},coupons:function(t){this.formData.coupons=t}},methods:{init:function(){this.formData.aim=this.aim,this.formData.title=this.title,this.formData.description=this.description,this.formData.integral=this.integral,this.formData.growth=this.growth,this.formData.type=this.type,this.formData.coupons=this.coupons},cancel:function(){this.loading=!1},submit:function(){var t=this;this.$refs.form.validate((function(e){e&&!t.loading&&(t.loading=!0,t.$emit("submit",{title:t.formData.title,aim:parseInt(t.formData.aim,10),type:t.formData.type,description:t.formData.description,integral:parseInt(t.formData.integral,10),growth:parseInt(t.formData.growth,10),coupons:t.formData.coupons}))}))},reset:function(){this.init(),-1===this.id&&this.$refs.form.resetFields()}},mounted:function(){var t=this;this.init(),s.a.get("/api/coupon/all").then((function(e){var a=e.data,i=a.code,n=a.data;0!==i?t.$message.error("è·å–æ•°æ®å¤±è´¥ï¼"):t.options=n.map((function(t){return{label:"".concat(t.integral,"ç§¯åˆ†ä¼˜æƒ å·"),value:t.id}}))}))}},c=l,u=a("2877"),p=Object(u["a"])(c,i,n,!1,null,null,null);e["a"]=p.exports},"7db0":function(t,e,a){"use strict";var i=a("23e7"),n=a("b727").find,o=a("44d2"),s=a("ae40"),r="find",l=!0,c=s(r);r in[]&&Array(1)[r]((function(){l=!1})),i({target:"Array",proto:!0,forced:l||!c},{find:function(t){return n(this,t,arguments.length>1?arguments[1]:void 0)}}),o(r)},"83f0":function(t,e,a){},"93dc":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"coupon-list-container"},[a("div",{staticClass:"header"},[a("task-search",{on:{submit:t.search}}),a("el-button",{attrs:{type:"danger",size:"medium",disabled:t.disabled||0===t.list.length||0===t.ids.length},on:{click:function(e){return t.openDialog(t.batchDelete)}}},[t._v("æ‰¹é‡åˆ é™¤")])],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{data:t.list},on:{"selection-change":t.select}},[a("el-table-column",{attrs:{type:"selection"}}),a("el-table-column",{attrs:{label:"æ ‡é¢˜",prop:"title"}}),a("el-table-column",{attrs:{label:"ç±»å‹"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticClass:"emoji"},[t._v(t._s(t.emoji[e.row.type]))])]}}])}),a("el-table-column",{attrs:{label:"ç›®æ ‡"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.aim+(0===e.row.type?"km":"æ¬¡"))+" ")]}}])}),a("el-table-column",{attrs:{label:"ç§¯åˆ†",prop:"integral"}}),a("el-table-column",{attrs:{label:"æˆé•¿å€¼",prop:"growth"}}),a("el-table-column",{attrs:{prop:"description",label:"ä»»åŠ¡è¦æ±‚","min-width":"300px"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"multipart-line-2"},[t._v(t._s(e.row.description))])]}}])}),a("el-table-column",{attrs:{label:"ä¼˜æƒ å·"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"medium",type:"success"},on:{click:function(a){return t.openView(e.row)}}},[t._v("æŸ¥çœ‹")])]}}])}),a("el-table-column",{attrs:{label:"æ“ä½œ",width:"220px"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"primary",size:"medium",disabled:t.disabled},on:{click:function(a){return t.beforeOpenEdit(e.row)}}},[t._v("ç¼–è¾‘")]),a("single-delete",{attrs:{id:e.row.id,url:"/api/task/delete"},on:{"single-delete":t.singleDelete,"open-dialog":t.openDialog}})]}}])})],1),a("custom-pagination",{attrs:{currentPage:t.currentPage,pageSize:t.pageSize,total:t.total},on:{pageChange:t.pageChange}}),a("custom-dialog",{attrs:{visible:t.dialog},on:{close:t.closeDialog,determine:t.handler}}),a("transition",{attrs:{name:"fade"}},[a("task-edit",{directives:[{name:"show",rawName:"v-show",value:t.edit,expression:"edit"}],attrs:{target:t.target},on:{close:t.closeEdit,submit:t.submit}})],1),a("transition",{attrs:{name:"fade"}},[a("coupon-list",{directives:[{name:"show",rawName:"v-show",value:t.view,expression:"view"}],attrs:{coupons:t.target.coupons},on:{close:t.closeView}})],1)],1)},n=[],o=(a("a4d3"),a("e01a"),a("7db0"),a("bc3a")),s=a.n(o),r=a("a9b3"),l=a("55c3"),c=a("dfc6"),u=a("daef"),p=a("20c5"),d=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("custom-mask",[a("div",{staticClass:"task-edit-container"},[a("span",{staticClass:"icon",on:{click:t.close}},[a("i",{staticClass:"el-icon-close"})]),a("task-form",{ref:"form",attrs:{id:t.target.id,title:t.target.title,aim:t.target.aim,type:t.target.type,description:t.target.description,integral:t.target.integral,growth:t.target.growth,coupons:t.target.coupons?t.target.coupons.map((function(t){return t.id})):[]},on:{submit:t.submit}})],1)])},f=[],m=(a("4de4"),a("4160"),a("e439"),a("dbb4"),a("b64b"),a("d3b7"),a("e6cf"),a("a79d"),a("159b"),a("ade3")),g=a("732e"),h=a("1f69");function b(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,i)}return a}function v(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?b(Object(a),!0).forEach((function(e){Object(m["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):b(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var y={name:"MerchandiseEdit",props:{target:{type:Object,default:function(){return{}}}},components:{TaskForm:g["a"],CustomMask:h["a"]},methods:{submit:function(t){var e=this;s.a.post("/api/task/edit",v({id:this.target.id},t),{headers:{"Content-Type":"application/json;charset=UTF-8"}}).then((function(a){var i=a.data.code;if(0===i)return e.$emit("submit",t),void e.$message.success("æäº¤æˆåŠŸï¼");e.$message.error("æäº¤å¤±è´¥ï¼")})).finally((function(){e.$refs.form.cancel()}))},close:function(){this.$emit("close")}}},D=y,w=(a("26fd"),a("a9d6"),a("2877")),k=Object(w["a"])(D,d,f,!1,null,"49f6c768",null),_=k.exports,$=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-form",{attrs:{inline:!0,model:t.formData},nativeOn:{submit:function(t){t.preventDefault()}}},[a("el-form-item",[a("el-select",{attrs:{placeholder:"ç±»å‹"},model:{value:t.formData.type,callback:function(e){t.$set(t.formData,"type",e)},expression:"formData.type"}},t._l(t.options,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"medium"},on:{click:t.submit}},[t._v("æŸ¥è¯¢")])],1)],1)},C=[],x={name:"TaskSearch",data:function(){return{formData:{type:-1},options:[{value:-1,label:"å…¨éƒ¨"},{value:0,label:"éª‘è¡Œ"},{value:1,label:"å…¬äº¤"},{value:2,label:"åœ°é“"},{value:3,label:"é«˜é“"}]}},methods:{submit:function(){this.$emit("submit",this.formData.type)}}},O=x,j=(a("fea8"),Object(w["a"])(O,$,C,!1,null,"31d0476a",null)),S=j.exports,E=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("custom-mask",{on:{click:t.close}},[a("div",{staticClass:"coupon-list-container"},[a("ul",{staticClass:"coupon-list"},t._l(t.coupons,(function(t){return a("li",{key:t.id,staticClass:"item"},[a("coupon",{attrs:{integral:t.integral,day:t.day,description:t.description}})],1)})),0),0===t.coupons.length?a("p",{staticClass:"empty"},[t._v("æš‚æ— æ•°æ®")]):t._e()])])},P=[],N=a("d4f3"),T={name:"CouponList",props:{coupons:{type:Array,default:function(){return[]}}},components:{CustomMask:h["a"],Coupon:N["a"]},methods:{close:function(){this.$emit("close")}}},z=T,q=(a("22bf"),a("647d"),Object(w["a"])(z,E,P,!1,null,"74a30d64",null)),F=q.exports,M={name:"TaskList",mixins:[l["a"]],data:function(){return{character:"task",url:{data:"/api/task/list",total:"/api/task/total"},condition:{type:-1},currentPage:1,pageSize:6,view:!1,handler:function(){},emoji:["ğŸš´","ğŸšŒ","ğŸšŠ","ğŸšˆ"]}},components:{CustomPagination:c["a"],CustomDialog:u["a"],SingleDelete:p["a"],TaskEdit:_,TaskSearch:S,CouponList:F},methods:{couponsData:function(t){var e=this;0===t.coupons.length&&s.a.get("/api/task/coupons",{params:{id:t.id}}).then((function(a){var i=a.data,n=i.code,o=i.data;if(0!==n)e.$message.error("è¯·æ±‚æ•°æ®å¤±è´¥ï¼");else{var s=e.list.find((function(e){return e.id===t.id}));s.coupons=o}}))},search:function(t){this.condition.type=t,this.currentPage=1,r["a"].set(this.character,{}),this.getData(),this.getTotal()},batchDelete:function(){var t=this;return s.a.post("/api/task/delete",{ids:this.ids}).then((function(e){var a=e.data.code;0===a?(t.$message.success("åˆ é™¤æˆåŠŸï¼"),1!==t.currentPage&&t.currentPage===t.pageCount&&t.ids.length===t.list.length&&(t.currentPage-=1),t.total-=t.ids.length,t.core(),t.ids=[]):t.$message.error("åˆ é™¤å¤±è´¥ï¼")}))},submit:function(t){var e=t.title,a=t.aim,i=t.type,n=t.description,o=t.integral,s=t.growth;this.target.title=e,this.target.aim=a,this.target.type=i,this.target.description=n,this.target.integral=o,this.target.growth=s,this.target.coupons=[],this.closeEdit()},openView:function(t){this.couponsData(t),this.target=t,this.view=!0},closeView:function(){this.view=!1},beforeOpenEdit:function(t){this.couponsData(t),this.openEdit(t)}}},A=M,V=(a("57af"),Object(w["a"])(A,i,n,!1,null,"101f7dc0",null));e["default"]=V.exports},99410:function(t,e,a){},a1dd:function(t,e,a){},a9d6:function(t,e,a){"use strict";var i=a("ac4e"),n=a.n(i);n.a},ac4e:function(t,e,a){},c1a1:function(t,e,a){"use strict";var i=a("2d23"),n=a.n(i);n.a},d4f3:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"coupon-container"},[a("div",{staticClass:"primary"},[a("div",{staticClass:"left"},[a("p",{staticClass:"integral-container"},[a("i",{staticClass:"icon icon-tubiao311 iconfont"}),a("span",{staticClass:"integral"},[t._v(t._s(t.integral))])]),a("p",{staticClass:"text"},[t._v("ä¼˜æƒ å·")])]),a("div",{staticClass:"middle"},[a("p",{staticClass:"title"},[t._v(t._s(t.integral)+"ç§¯åˆ†æŠµç”¨å·")]),a("p",{staticClass:"overdue"},[t._v("æœ‰æ•ˆæœŸè‡³: "+t._s(t.overdue))]),a("p",{staticClass:"rule",on:{click:t.toggle}},[t._v("ä½¿ç”¨è§„åˆ™ "),a("i",{staticClass:"icon",class:"el-icon-arrow-"+(t.collapsed?"up":"down")})])]),t._m(0)]),a("div",{directives:[{name:"show",rawName:"v-show",value:t.collapsed,expression:"collapsed"}],staticClass:"secondary"},[a("p",[t._v(t._s(t.description))])])])},n=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"right"},[a("div",{staticClass:"use-btn"},[t._v("ç«‹å³ä½¿ç”¨")])])}],o=(a("a9e3"),a("c1df")),s=a.n(o),r={name:"Coupon",props:{integral:{type:Number,default:0},day:{type:Number,default:1},description:{type:String,default:""}},data:function(){return{collapsed:!1}},computed:{overdue:function(){return s()(new Date(Date.now()+24*this.day*60*60*1e3)).format("YYYY-MM-DD")}},methods:{toggle:function(){this.collapsed=!this.collapsed}}},l=r,c=(a("c1a1"),a("2877")),u=Object(c["a"])(l,i,n,!1,null,"9026764a",null);e["a"]=u.exports},f03a:function(t,e,a){},fea8:function(t,e,a){"use strict";var i=a("f03a"),n=a.n(i);n.a}}]);
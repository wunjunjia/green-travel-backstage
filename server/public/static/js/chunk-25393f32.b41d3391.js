(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-25393f32"],{"02ed":function(t,e,a){"use strict";var i=a("1205"),r=a.n(i);r.a},"04ed":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-form",{ref:"form",attrs:{model:t.formData,rules:t.rules,"label-width":"80px","status-icon":""}},[a("el-form-item",{attrs:{label:"名称",prop:"name"}},[a("el-input",{on:{blur:function(e){return t.trim("name")}},model:{value:t.formData.name,callback:function(e){t.$set(t.formData,"name",e)},expression:"formData.name"}})],1),a("el-form-item",{attrs:{label:"碳积分",prop:"integral"},on:{blur:function(e){return t.trim("integral")}}},[a("el-input",{model:{value:t.formData.integral,callback:function(e){t.$set(t.formData,"integral",e)},expression:"formData.integral"}})],1),a("el-form-item",{attrs:{label:"库存",prop:"stock"},on:{blur:function(e){return t.trim("stock")}}},[a("el-input",{model:{value:t.formData.stock,callback:function(e){t.$set(t.formData,"stock",e)},expression:"formData.stock"}})],1),a("el-form-item",{attrs:{label:"状态",required:""}},[a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},model:{value:t.formData.status,callback:function(e){t.$set(t.formData,"status",e)},expression:"formData.status"}})],1),a("el-form-item",{attrs:{label:"描述",prop:"description"}},[a("el-input",{attrs:{type:"textarea",clearable:"",maxlength:"300","show-word-limit":"",resize:"none",rows:"5"},on:{blur:function(e){return t.trim("description")}},model:{value:t.formData.description,callback:function(e){t.$set(t.formData,"description",e)},expression:"formData.description"}})],1),a("el-form-item",{attrs:{label:"图片",required:""}},[a("el-upload",{staticClass:"upload-container",attrs:{action:"/api/upload/merchandise",name:"merchandise",data:{name:"merchandise"},"show-file-list":!1,"before-upload":t.beforeUpload,"on-success":t.success,"on-error":t.error,accept:t.accept}},[t.imageUrl?a("div",{staticClass:"avatar-container"},[a("custom-image",{attrs:{url:t.imageUrl},on:{load:function(e){return t.load(t.imageUrl)}}})],1):a("div",{staticClass:"content-container"},[a("i",{staticClass:"el-icon-plus"})])])],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",loading:t.loading},on:{click:t.submit}},[t._v("提交")]),a("el-button",{on:{click:t.reset}},[t._v("重置")])],1)],1)},r=[],s=(a("a4d3"),a("e01a"),a("b0c0"),a("a9e3"),a("e49c")),n=a("9a2e"),o=a("11f8"),c={name:"MerchandiseForm",mixins:[s["a"],n["a"]],props:{id:{type:Number,default:-1},name:{type:String,default:""},integral:{type:String,default:""},stock:{type:String,default:""},status:{type:Boolean,default:!0},description:{type:String,default:""},path:{type:String,default:""}},data:function(){return{formData:{name:"",description:"",integral:"",stock:"",status:!0},rules:{name:[{required:!0,message:"不能为空",whitespace:!0}],integral:[{required:!0,message:"不能为空"},{pattern:/(^[1-9][0-9]{0,4}(\.[0-9]{1,2})?$)|(^0?\.[0-9]{1,2}$)/,message:"不符合要求"}],stock:[{required:!0,message:"不能为空"},{pattern:/^(0|[1-9][0-9]{0,4})$/,message:"不符合要求"}],description:[{required:!0,message:"不能为空",whitespace:!0}]},loading:!1,maxUploadCount:1}},components:{CustomImage:o["a"]},watch:{id:function(){this.init()}},computed:{imageUrl:function(){return this.fileList[0].imageUrl}},created:function(){this.init()},methods:{init:function(){if(-1===this.id)return this.formData.status=!0,void(this.fileList=[{imageUrl:"",path:""}]);this.formData.name=this.name,this.formData.description=this.description,this.formData.integral=this.integral,this.formData.status=this.status,this.formData.stock=this.stock,this.fileList=[{path:this.path,imageUrl:this.path}]},cancel:function(){this.loading=!1},submit:function(){var t=this;""!==this.fileList[0].path?this.$refs.form.validate((function(e){e&&!t.loading&&(t.loading=!0,t.$emit("submit",{name:t.formData.name,description:t.formData.description,status:t.formData.status?1:0,stock:parseInt(t.formData.stock,10),integral:parseFloat(t.formData.integral),path:t.fileList[0].path}))})):this.$message.error("请选择一张图片！")},reset:function(){this.init(),-1===this.id&&this.$refs.form.resetFields()}}},l=c,m=(a("02ed"),a("2877")),u=Object(m["a"])(l,i,r,!1,null,"4d975e72",null);e["a"]=u.exports},1205:function(t,e,a){},"4c35":function(t,e,a){},"68b1":function(t,e,a){"use strict";var i=a("4c35"),r=a.n(i);r.a},f652:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"merchandise-add-container"},[a("el-row",[a("el-col",{attrs:{xs:24,sm:18,md:12}},[a("merchandise-form",{ref:"form",on:{submit:t.submit}})],1)],1)],1)},r=[],s=(a("a4d3"),a("e01a"),a("b0c0"),a("d3b7"),a("e6cf"),a("a79d"),a("bc3a")),n=a.n(s),o=a("c1df"),c=a.n(o),l=a("04ed"),m={name:"MerchandiseAdd",components:{MerchandiseForm:l["a"]},methods:{submit:function(t){var e=this,a=t.name,i=t.description,r=t.integral,s=t.path,o=t.status,l=t.stock;n.a.post("/api/merchandise/save",{name:a,description:i,integral:parseFloat(r),status:o,stock:l,path:s,create_time:c()().format("YYYY-MM-DD")},{headers:{"Content-Type":"application/json; charset=UTF-8"}}).then((function(t){var a=t.data.code;0===a?e.$message.success("提交成功！"):e.$message.error("提交失败！")})).finally((function(){e.$refs.form.cancel()}))}}},u=m,f=(a("68b1"),a("2877")),d=Object(f["a"])(u,i,r,!1,null,"644ba8e9",null);e["default"]=d.exports}}]);